From 3f427f8a3a64e03112533da08acd46599414f4e9 Mon Sep 17 00:00:00 2001
From: bggmtt <bggmtt@33a7eb43-6648-0410-933e-cf740565ad39>
Date: Tue, 26 Feb 2013 02:36:09 +0000
Subject: [PATCH] Fixed an access violation with apply and cancel buttons when
 the file list is empty

git-svn-id: https://winff.googlecode.com/svn@741 33a7eb43-6648-0410-933e-cf740565ad39
---
 trunk/winff/unit1.pas |    5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

--- a/unit1.pas
+++ b/unit1.pas
@@ -1792,13 +1792,15 @@
 procedure TfrmMain.lblSaveChangesClick(Sender: TObject);
 var
 pn : string;
-begin
+begin                   // check preset
      pn:=getcurrentpresetname(presetbox.Text);
      if pn='' then
        begin
        showmessage(rsPleaseSelectAPreset);
        exit;
        end;
+                        // check for files to apply to
+     if filelist.Items.Count = 0 then exit;
 
      if  pgSettings.ActivePageIndex = 5 then
       begin
@@ -1813,6 +1815,7 @@
 procedure TfrmMain.lblCancelChangesClick(Sender: TObject);
 begin
   // Undo Changes;
+   if filelist.Items.Count = 0 then exit;
    GetScr(filelist.ItemIndex);
    pnlAllow.Visible:= False;
    Application.ProcessMessages;
